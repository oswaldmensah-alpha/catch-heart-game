<!DOCTYPE html>
<html>
<head>
    <title>Heart Catcher: Level Edition</title>
    <style>
        body { margin: 0; background: #ffe6ea; font-family: 'Arial', sans-serif; overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #game-container { position: relative; width: 400px; height: 600px; background: white; border: 5px solid #ff4d6d; border-radius: 20px; overflow: hidden; }
        
        /* Screens */
        .screen { position: absolute; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: white; z-index: 20; }
        .hidden { display: none !important; }

        /* UI Elements */
        #player { position: absolute; bottom: 20px; left: 175px; width: 80px; height: 40px; background: #ff4d6d; color: white; display: flex; justify-content: center; align-items: center; border-radius: 10px; font-weight: bold; z-index: 10; }
        .heart { position: absolute; font-size: 30px; z-index: 5; }
        #stats { position: absolute; top: 10px; width: 100%; display: flex; justify-content: space-around; font-size: 18px; color: #ff4d6d; font-weight: bold; z-index: 15; }
        
        button { padding: 10px 25px; margin: 10px; font-size: 1rem; border: none; border-radius: 10px; cursor: pointer; background: #ff4d6d; color: white; transition: 0.3s; }
        button:hover { background: #d63384; transform: scale(1.1); }
    </style>
</head>
<body>

<div id="game-container">
    <div id="stats">
        <div id="score">Hearts: 0</div>
        <div id="timer">Time: 30</div>
    </div>

    <div id="start-screen" class="screen">
        <h1>Choose a Level</h1>
        <button onclick="startGame('easy')">Easy</button>
        <button onclick="startGame('medium')">Medium</button>
        <button onclick="startGame('hard')">Hard</button>
    </div>

    <div id="end-screen" class="screen hidden">
        <h1>Time's Up!</h1>
        <p id="final-score" style="font-size: 24px; color: #ff4d6d;"></p>
        <button onclick="location.reload()">Play Again</button>
    </div>

    <div id="player" class="hidden">YOU</div>
</div>

<script>
    const container = document.getElementById('game-container');
    const player = document.getElementById('player');
    const scoreElement = document.getElementById('score');
    const timerElement = document.getElementById('timer');
    const startScreen = document.getElementById('start-screen');
    const endScreen = document.getElementById('end-screen');
    
    let score = 0;
    let timeLeft = 30;
    let playerX = 175;
    let gameActive = false;
    let settings = { speed: 3, frequency: 1000 };

    function startGame(level) {
        if (level === 'easy') { settings = { speed: 3, frequency: 1200 }; }
        if (level === 'medium') { settings = { speed: 5, frequency: 800 }; }
        if (level === 'hard') { settings = { speed: 8, frequency: 500 }; }

        startScreen.classList.add('hidden');
        player.classList.remove('hidden');
        gameActive = true;
        
        // Start Loops
        const gameTimer = setInterval(() => {
            timeLeft--;
            timerElement.innerText = 'Time: ' + timeLeft;
            if (timeLeft <= 0) {
                clearInterval(gameTimer);
                endGame();
            }
        }, 1000);

        spawnLoop();
    }

    function spawnLoop() {
        if (!gameActive) return;
        createHeart();
        setTimeout(spawnLoop, settings.frequency);
    }

    function createHeart() {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.innerHTML = '❤️';
        heart.style.left = Math.random() * 370 + 'px';
        heart.style.top = '-50px';
        container.appendChild(heart);

        let fallInterval = setInterval(() => {
            if (!gameActive) { clearInterval(fallInterval); heart.remove(); return; }
            
            let top = parseInt(heart.style.top);
            if (top > 600) {
                clearInterval(fallInterval);
                heart.remove();
            } else {
                heart.style.top = (top + settings.speed) + 'px';
                
                let hRect = heart.getBoundingClientRect();
                let pRect = player.getBoundingClientRect();

                if (hRect.bottom >= pRect.top && hRect.right >= pRect.left && hRect.left <= pRect.right) {
                    score++;
                    scoreElement.innerText = 'Hearts: ' + score;
                    clearInterval(fallInterval);
                    heart.remove();
                }
            }
        }, 20);
    }

    // Controls
    container.addEventListener('mousemove', (e) => {
        let rect = container.getBoundingClientRect();
        playerX = e.clientX - rect.left - 40;
        if (playerX < 0) playerX = 0;
        if (playerX > 320) playerX = 320;
        player.style.left = playerX + 'px';
    });

    function endGame() {
        gameActive = false;
        player.classList.add('hidden');
        endScreen.classList.remove('hidden');
        document.getElementById('final-score').innerText = "You caught " + score + " hearts for Oswald!";
    }
</script>
</body>
</html>